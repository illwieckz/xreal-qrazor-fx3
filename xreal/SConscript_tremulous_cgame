import os, string, sys

Import('env')

# the file with vmMain function MUST be the first one of the list
cgame_src = [
'tremulous/code/cgame/cg_main.c',
'tremulous/code/game/bg_misc.c',
'tremulous/code/game/bg_pmove.c',
'tremulous/code/game/bg_slidemove.c',
'tremulous/code/ui/ui_shared.c',
'code/qcommon/q_math.c',
'code/qcommon/q_shared.c',
'tremulous/code/cgame/cg_animation.c',
'tremulous/code/cgame/cg_animmapobj.c',
'tremulous/code/cgame/cg_attachment.c',
'tremulous/code/cgame/cg_buildable.c',
'tremulous/code/cgame/cg_consolecmds.c',
'tremulous/code/cgame/cg_draw.c',
'tremulous/code/cgame/cg_drawtools.c',
'tremulous/code/cgame/cg_ents.c',
'tremulous/code/cgame/cg_event.c',
'tremulous/code/cgame/cg_marks.c',
'tremulous/code/cgame/cg_mem.c',
'tremulous/code/cgame/cg_particles.c',
'tremulous/code/cgame/cg_players.c',
'tremulous/code/cgame/cg_playerstate.c',
'tremulous/code/cgame/cg_predict.c',
'tremulous/code/cgame/cg_ptr.c',
'tremulous/code/cgame/cg_scanner.c',
'tremulous/code/cgame/cg_servercmds.c',
'tremulous/code/cgame/cg_snapshot.c',
'tremulous/code/cgame/cg_trails.c',
'tremulous/code/cgame/cg_tutorial.c',
'tremulous/code/cgame/cg_view.c',
'tremulous/code/cgame/cg_weapons.c'
]

dll_src = [
'tremulous/code/cgame/cg_syscalls.c'
]

cgame_env = env.Clone()

if env['arch'] == 'linux-i386':
	cgame_env.SharedLibrary('cgame', [cgame_src, dll_src], LIBS=['m'])
	cgame_env.InstallAs('#tremulous/cgamei386.so', 'libcgame.so')

elif env['arch'] == 'linux-x86_64':
	cgame_env.SharedLibrary('cgame', [cgame_src, dll_src], LIBS=['m'])
	cgame_env.InstallAs('#tremulous/cgamex86_64.so', 'libcgame.so')

elif env['arch'] == 'sdl':
	cgame_env.SharedLibrary('cgame', [cgame_src, dll_src], LIBS=['m'])
	cgame_env.InstallAs('#tremulous/cgame.so', 'libcgame.so')

elif env['arch'] == 'freebsd-i386':
	cgame_env.SharedLibrary('cgame', [cgame_src, dll_src], LIBS=['m'])
	cgame_env.InstallAs('#tremulous/cgamei386.so', 'libcgame.so')

elif env['arch'] == 'freebsd-amd64':
	cgame_env.SharedLibrary('cgame', [cgame_src, dll_src], LIBS=['m'])
	cgame_env.InstallAs('#tremulous/cgameamd64.so', 'libcgame.so')

elif env['arch'] == 'win32-mingw':
	cgame_env.SharedLibrary('cgame', [cgame_src, dll_src], LIBS=['m'])
	cgame_env.InstallAs('#tremulous/cgamex86.dll', 'cgame.dll')


